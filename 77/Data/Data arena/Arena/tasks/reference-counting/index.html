<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Data/Data arena/Arena/tasks/reference-counting/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">README | Operating Systems</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//operating-systems/77/Data/Data arena/Arena/tasks/reference-counting/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="README | Operating Systems"><meta data-rh="true" name="description" content="Operator overloading"><meta data-rh="true" property="og:description" content="Operator overloading"><link data-rh="true" rel="canonical" href="http://localhost//operating-systems/77/Data/Data arena/Arena/tasks/reference-counting/"><link data-rh="true" rel="alternate" href="http://localhost//operating-systems/77/Data/Data arena/Arena/tasks/reference-counting/" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//operating-systems/77/Data/Data arena/Arena/tasks/reference-counting/" hreflang="x-default"><link rel="stylesheet" href="/operating-systems/77/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/operating-systems/77/assets/js/runtime~main.f92f10a0.js" as="script">
<link rel="preload" href="/operating-systems/77/assets/js/main.e93c2cc5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/operating-systems/77/"><div class="navbar__logo"><img src="/operating-systems/77/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/operating-systems/77/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SO</b></a><a class="navbar__item navbar__link" href="/operating-systems/77/Software Stack">Software Stack</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/operating-systems/77/Data">Data</a><a class="navbar__item navbar__link" href="/operating-systems/77/Lecture">Lecture</a><a class="navbar__item navbar__link" href="/operating-systems/77/Lab">Lab</a><a class="navbar__item navbar__link" href="/operating-systems/77/Assignments">Assignments</a><a class="navbar__item navbar__link" href="/operating-systems/77/Exams">Exams</a><a class="navbar__item navbar__link" href="/operating-systems/77/Hackathons">Hackathons</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>README</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="operator-overloading">Operator overloading<a class="hash-link" href="#operator-overloading" title="Direct link to heading">​</a></h3><p>Navigate to the <code>support/reference-counting</code> directory.
Analyze the <code>operators.d</code> file.
A <code>struct</code> is defined that also implements 4 special functions: a constructor, a copy constructor, an assignment operator and a destructor.
Each of these special functions may be called automatically by the compiler:</p><ul><li>the constructor is called automatically whenever an object is initialized with a field of a type that corresponds to the constructor parameter type.</li><li>the copy constructor is called automatically when an object is initialized from an object of the same type.</li><li>the assignment operator is called automatically when an object is assigned an object of the same type.</li><li>the destructor is called automatically whenever an object goes out of scope.</li></ul><p><strong>Note: the difference between initialization and assignment is that the initialization occurs when an object is being declared and occurs a single time (<code>Obj o1 = 1</code>), whereas assignment is decoupled from the declaration site and may occur multiple times (provided that the variable is mutable).</strong></p><p>Compile and run the program in <code>operators.d</code>.
Notice how the different special functions are automatically called.
Considering the definition of <code>Obj</code> from the file <code>operators.d</code>, answer the following <a href="/operating-systems/77/Data/Data arena/Arena/tasks/drills/questions/operators.md">Quiz</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="practice">Practice<a class="hash-link" href="#practice" title="Direct link to heading">​</a></h4><p>Navigate to the <code>support/reference-counting</code> directory.
Analyze the <code>refcount_skel.d</code>.
A reference counted <code>int</code> array is implemented, however, some bits are missing.
Run the code, try to understand what happens.</p><p>The constructor allocates memory for the array, whereas the destructor deallocates it.
Compile and run the code.
Notice how the array&#x27;s memory  is automatically managed.</p><ol><li><p>Uncomment the following line in the <code>main</code> function (<code>//test1()</code>).
Run the code.
What happens?
Why?</p></li><li><p>The reference counted array does not implement the copy constructor.
Comment the <code>version(none)</code> annotation for the copy constructor and implement the logic so that the reference counted array is correct.
When an object is initialized from another object, we need to appropriately set the fields and then increment the reference count.
Once you have completed this exercise, make sure the output is correct and that the reference counted array is not freed too early.</p></li><li><p>Uncomment the following line in the <code>main</code> function (<code>//test2()</code>).
Run the code.
What happens?
Why?
Use GDB to find out.</p></li><li><p>The reference counted array does not implement the assignment operator.
Comment the <code>version(none)</code> annotation for the assignment operator and implement the logic so that the reference counted array is correct.
When an object is assigned to another object, we need to first decrement the count for the object that is being assigned to, then fill the fields similarly to the copy constructor case and lastly increment the count for the assigned object.
After completing the exercise, make sure that the memory is properly managed.</p></li><li><p>Play with your reference counted array and create different scenarios to test its limits.</p></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#operator-overloading" class="table-of-contents__link toc-highlight">Operator overloading</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://curs.upb.ro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ocw.cs.pub.ro/courses/so" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/sisteme.de.operare/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 SO Team</div></div></div></footer></div>
<script src="/operating-systems/77/assets/js/runtime~main.f92f10a0.js"></script>
<script src="/operating-systems/77/assets/js/main.e93c2cc5.js"></script>
</body>
</html>